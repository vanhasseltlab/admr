[{"path":"https://hiddevandebeek.github.io/admr/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 H. van de Beek Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://hiddevandebeek.github.io/admr/articles/admr.html","id":"example-of-using-admr-with-rxode2","dir":"Articles","previous_headings":"","what":"Example of using admr with rxode2","title":"Get started with `admr`","text":"Import admr packages: scenario, use examplomycin dataset demonstrate use admr package rxode2 package. show manipulate dataset get right format admr package. future scenarios, might access individual dataset, vignette demonstrates right format.","code":"library(admr) library(rxode2) library(nlmixr2) library(dplyr) library(tidyr) library(mnorm) head(examplomycin) #>    ID TIME    DV AMT EVID CMT #> 1 460 0.00 0.000 100  101   1 #> 2 460 0.10 0.752   0    0   2 #> 3 460 0.25 1.932   0    0   2 #> 4 460 0.50 3.694   0    0   2 #> 5 460 1.00 3.479   0    0   2 #> 6 460 2.00 4.003   0    0   2 examplomycin_wide <- examplomycin %>%   filter(EVID != 101) %>%   dplyr::select(ID, TIME, DV) %>%  # Select only the relevant columns   pivot_wider(names_from = TIME, values_from = DV) %>%   dplyr::select(-c(1))  examplomycin_aggregated <- examplomycin_wide %>%   admr::meancov()  head(examplomycin_aggregated) #> $E #>      0.1     0.25      0.5        1        2        3        5        8  #> 0.966418 1.938774 2.787908 3.024706 2.257656 1.650808 1.063120 0.751180  #>       12  #> 0.512168  #>  #> $V #>               0.1         0.25         0.5           1          2           3 #> 0.1   0.210318331  0.307810566  0.34863077 0.202610737 0.02244783 -0.04472722 #> 0.25  0.307810566  0.707512991  0.65887098 0.416118052 0.05871261 -0.07441765 #> 0.5   0.348630772  0.658870977  1.09983366 0.530554165 0.10572618 -0.07538386 #> 1     0.202610737  0.416118052  0.53055416 0.803744604 0.16252833  0.02792441 #> 2     0.022447834  0.058712608  0.10572618 0.162528331 0.34465070  0.12026872 #> 3    -0.044727222 -0.074417647 -0.07538386 0.027924410 0.12026872  0.24989260 #> 5    -0.018976800 -0.042420657 -0.04648286 0.001618855 0.07644080  0.11148574 #> 8    -0.006630907 -0.011273701 -0.01981830 0.016197981 0.06398700  0.07493319 #> 12   -0.005625994 -0.005018766 -0.01492001 0.014748325 0.04941463  0.05460018 #>                 5            8           12 #> 0.1  -0.018976800 -0.006630907 -0.005625994 #> 0.25 -0.042420657 -0.011273701 -0.005018766 #> 0.5  -0.046482865 -0.019818299 -0.014920009 #> 1     0.001618855  0.016197981  0.014748325 #> 2     0.076440801  0.063987002  0.049414630 #> 3     0.111485737  0.074933189  0.054600176 #> 5     0.154215442  0.087680168  0.061332530 #> 8     0.087680168  0.096530356  0.057621124 #> 12    0.061332530  0.057621124  0.057988752"},{"path":"https://hiddevandebeek.github.io/admr/articles/admr.html","id":"defining-the-rxode-model","dir":"Articles","previous_headings":"Example of using admr with rxode2","what":"Defining the RxODE model","title":"Get started with `admr`","text":"define two-compartment model examplomycin dataset. model following differential equations: solved model available two-compartment model, speeding simulation process. linCmt function multiple solved models. function takes following arguments:","code":"rxModel <- RxODE({   # Parameters   ke = cl / v1             # Elimination rate constant   k12 = q / v1             # Rate constant for central to peripheral transfer   k21 = q / v2             # Rate constant for peripheral to central transfer      # Differential equations for drug amount in compartments   d/dt(depot)    = -ka * depot   d/dt(central)  = ka * depot - ke * central - k12 * central + k21 * peripheral   d/dt(peripheral) = k12 * central - k21 * peripheral      # Concentration in the central compartment   cp = central / v1 }) rxModel <- RxODE({   cp = linCmt(    # Solved one- or two-compartment model     cl,           # Clearance     v1,           # Volume of the central compartment     v2,           # Volume of the peripheral compartment     q,            # Inter-compartmental clearance     ka            # Absorption rate constant   ) })"},{"path":"https://hiddevandebeek.github.io/admr/articles/admr.html","id":"defining-the-prediction-function","dir":"Articles","previous_headings":"Example of using admr with rxode2","what":"Defining the prediction function","title":"Get started with `admr`","text":"necessary admr package simulate model. Tt constructs event table dosing sampling, solves RxODE model, extracts predicted concentrations. function can handle single multiple individuals. twocomp_g function g function two-compartment model. opts object contains options admr package. genopts function generates options object. parameters : vector time points sampling predictions model. observation times model predictions evaluated. Example: c(.1, .25, .5, 1, 2, 3, 5, 8, 12). Values population parameters (beta) covariance matrix (Omega). either initial values optimization true values simulation. Example: list(beta = c(cl = 5, v1 = 10, v2 = 30, q = 10, ka = 1), Omega = omegas(.09, 0, 5)). Number Monte Carlo samples per iteration. Higher values improve accuracy increase computation time. Example: 2500. Number individuals dataset. used Objective Function Value (OFV), AIC, BIC calculation. Example: 500. Currently used (future implementation). Intended define auxiliary distributions covariates additional random effects. Currently used (future implementation). Placeholder handling interactions different effects model. Currently used (future implementation). Placeholder enabling First-Order Approximation method parameter estimation. Currently used (future implementation). Placeholder pre-defined sequences random effects (bi) testing purposes. Factor covariance matrix (Omega) expanded estimation account uncertainty. Example: 2 doubles covariance matrix values temporarily sampling. prediction function simulates model outputs based individual parameters. Example: predder, specified . fitEM function fits model dataset. takes following arguments: output fitEM function. plot function can used visualize results. shows convergence model fit parameters making trace plot chains.","code":"predder <- function(time, theta_i, dose = 100) {     n_individuals <- nrow(theta_i)      # Create the event table for dosing and sampling     ev <- eventTable(amount.units=\"mg\", time.units=\"hours\")     ev$add.dosing(dose = dose, nbr.doses = 1, start.time = 0)  # Assume same dose     ev$add.sampling(time)  # Time points to simulate          # Solve the RxODE model for all individuals     out <- rxSolve(rxModel, params = theta_i, events = ev, cores = 0)          # Extract the predicted concentrations (cp) and format them as a matrix     cp_matrix <- matrix(out$cp, nrow = n_individuals, ncol = length(time),                          byrow = TRUE)          # Return matrix of predicted concentrations     return(cp_matrix) } opts <- genopts(time=c(.1,.25,.5,1,2,3,5,8,12),                   p=list(beta=c(cl = 5, v1 = 10, v2 = 30,q = 10, ka = 1),                   Omega=omegas(.09,0,5),Sigma_prop=0.04),                   nsim=2500,n=500,adist=NULL,                   interact=F,fo_appr=F,biseq=NA,omega_expansion=1.2,                   f=predder) fit <- fitEM(opts, examplomycin_aggregated, chains = 3) #> Chain 1: #> Iter | NLL and Parameters (11 values) #> -------------------------------------------------------------------------------- #>    1: -1839.577    1.609    2.303    3.401    2.303    0.000   -2.408   -2.408   -2.408   -2.408   -2.408   -3.219 #>  #> ### Wide Search Phase ### #>    2: -1845.236    1.601    2.309    3.404    2.284    0.020   -2.280   -2.165   -2.333   -2.245   -2.440   -3.235 #>    3: -1845.278    1.600    2.305    3.406    2.284    0.016   -2.287   -2.197   -2.344   -2.269   -2.414   -3.235 #>    4: -1845.278    1.600    2.305    3.406    2.284    0.016   -2.286   -2.197   -2.344   -2.268   -2.413   -3.235 #>    5: -1845.278    1.600    2.305    3.406    2.284    0.016   -2.286   -2.197   -2.344   -2.268   -2.413   -3.235 #>    6: -1845.278    1.600    2.305    3.406    2.284    0.016   -2.286   -2.198   -2.344   -2.268   -2.413   -3.235 #>    7: -1845.278    1.600    2.305    3.406    2.284    0.016   -2.286   -2.198   -2.344   -2.267   -2.413   -3.235 #>    8: -1845.278    1.600    2.305    3.406    2.285    0.016   -2.286   -2.198   -2.343   -2.267   -2.413   -3.235 #>    9: -1845.278    1.600    2.305    3.406    2.285    0.016   -2.286   -2.198   -2.343   -2.267   -2.413   -3.235 #> Phase Wide Search Phase converged at iteration 9. #>  #> ### Focussed Search Phase ### #>   10: -1845.279    1.601    2.306    3.405    2.285    0.017   -2.286   -2.199   -2.344   -2.266   -2.412   -3.235 #>   11: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.201   -2.343   -2.266   -2.411   -3.235 #>   12: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.201   -2.343   -2.265   -2.411   -3.235 #>   13: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.201   -2.343   -2.265   -2.410   -3.235 #>   14: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.201   -2.343   -2.265   -2.410   -3.235 #>   15: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.201   -2.343   -2.265   -2.410   -3.235 #>   16: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.201   -2.343   -2.265   -2.410   -3.235 #>   17: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.201   -2.343   -2.265   -2.410   -3.235 #> Phase Focussed Search Phase converged at iteration 17. #>  #> ### Fine-Tuning Phase ### #>   18: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.201   -2.343   -2.265   -2.410   -3.235 #> Phase Fine-Tuning Phase converged at iteration 18. #>  #> ### Precision Phase ### #>   19: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.201   -2.343   -2.265   -2.410   -3.235 #> Phase Precision Phase converged at iteration 19. #>  #> Chain 1 Complete: Final NLL = -1845.280, Time Elapsed = 5.36 seconds #>   #> Phase Wide Search Phase converged at iteration 11. #> Phase Focussed Search Phase converged at iteration 16. #> Phase Fine-Tuning Phase converged at iteration 21. #> Phase Precision Phase converged at iteration 29. #>  #> Chain 2 Complete: Final NLL = -1845.283, Time Elapsed = 7.74 seconds #>   #> Phase Wide Search Phase converged at iteration 6. #> Phase Focussed Search Phase converged at iteration 9. #>  #> Chain 3 Complete: Final NLL = -1845.284, Time Elapsed = 7.68 seconds #> print(fit) #> -- FitEM Summary -- #>  #> -- Objective Function and Information Criteria -- #>  Log-likelihood: -1845.2836 #>             AIC: 3701.57 #>             BIC: 3758.93 #> Condition#(Cov): 152.61 #> Condition#(Cor): 217.70 #>  #> -- Timing Information -- #>      Best Chain: 7.6843 seconds #>      All Chains: 20.7918 seconds #>      Covariance: 28.6807 seconds #>         Elapsed: 49.47 seconds #>  #> -- Population Parameters -- #> # A tibble: 6 × 6 #>   Parameter        Est.      SE  `%RSE` `Back-transformed(95%CI)` `BSV(CV%)` #>   <chr>           <dbl>   <dbl>   <dbl> <chr>                          <dbl> #> 1 cl             1.60    0.0153   0.955 4.95 (4.81, 5.11)               32.7 #> 2 v1             2.31    0.0867   3.75  10.08 (8.51, 11.95)             33.9 #> 3 v2             3.40    0.0402   1.18  30.09 (27.81, 32.55)            31.9 #> 4 q              2.28    0.0212   0.929 9.82 (9.42, 10.24)              33.1 #> 5 ka             0.0223  0.0818 368.    1.02 (0.87, 1.20)               30.9 #> 6 Residual Error 0.0394 NA       NA     0.0394                          NA   #>  #> -- Iteration Diagnostics -- #>  Iter | NLL and Parameters #> -------------------------------------------------------------------------------- #>    1: -992.169 1.504 2.710 3.645 2.512 0.000 -2.315 -2.003 -2.561 -2.519 -2.063 -3.428 #>    2: -1809.005 1.576 2.330 3.346 2.218 0.068 -2.288 -1.695 -2.078 -1.901 -2.610 -3.236 #>    3: -1845.284 1.600 2.311 3.404 2.285 0.022 -2.287 -2.217 -2.335 -2.267 -2.396 -3.235 #>    4: -1845.283 1.601 2.307 3.405 2.285 0.018 -2.286 -2.208 -2.341 -2.262 -2.402 -3.235 #>    5: -1845.283 1.601 2.307 3.405 2.285 0.018 -2.285 -2.206 -2.343 -2.265 -2.404 -3.235 #>    ... (omitted iterations) ... #>   25: -1845.281 1.601 2.308 3.405 2.285 0.019 -2.286 -2.201 -2.343 -2.263 -2.409 -3.235 #>   26: -1845.281 1.601 2.308 3.405 2.285 0.019 -2.286 -2.201 -2.343 -2.264 -2.409 -3.235 #>   27: -1845.281 1.601 2.308 3.405 2.285 0.019 -2.286 -2.201 -2.343 -2.263 -2.409 -3.235 #>   28: -1845.281 1.601 2.308 3.405 2.285 0.019 -2.286 -2.201 -2.343 -2.263 -2.409 -3.235 #>   29: -1845.281 1.601 2.308 3.405 2.285 0.019 -2.286 -2.201 -2.343 -2.264 -2.410 -3.235 plot(fit)"},{"path":"https://hiddevandebeek.github.io/admr/articles/examplomycin.html","id":"creating-the-examplomycin-dataset","dir":"Articles","previous_headings":"","what":"Creating the examplomycin dataset","title":"Examplomycin dataset","text":"vignette create simulated dataset fictional drug called examplomycin. dataset contain 500 subjects 9 timepoints . data generated using two-compartment model first-order absorption elimination. model parameters sampled multivariate normal distribution specified covariance matrix. dataset also include random error term simulate measurement noise. make dataset available data object package use vignettes.","code":""},{"path":"https://hiddevandebeek.github.io/admr/articles/examplomycin.html","id":"libraries","dir":"Articles","previous_headings":"Creating the examplomycin dataset","what":"Libraries","title":"Examplomycin dataset","text":"use following libraries generate data plot results:","code":"library(rxode2) library(MASS) library(ggplot2) library(nlmixr2) library(data.table) library(dplyr) library(ggplot2) library(usethis)"},{"path":"https://hiddevandebeek.github.io/admr/articles/examplomycin.html","id":"data-generating-function","dir":"Articles","previous_headings":"Creating the examplomycin dataset","what":"Data generating function","title":"Examplomycin dataset","text":"function generates examplomycin dataset. takes three arguments: n (number subjects), times (vector timepoints), seed (random seed reproducibility). function first defines two-compartment model using RxODE function. generates model parameters sampling multivariate normal distribution specified covariance matrix. function also generates event table simulation, including single dose 100 units time 0 observations specified timepoints. model solved using rxSolve function, simulated data stored data frame. function returns simulated dataset.","code":"generate_data <- function(n, times, seed = 1) {   set.seed(seed)      mod <- RxODE({     # Parameters     ke = cl / v1             # Elimination rate constant     k12 = q / v1             # Rate constant for central to peripheral transfer     k21 = q / v2             # Rate constant for peripheral to central transfer          # Differential equations for drug amount in compartments     d/dt(depot)    = -ka * depot     d/dt(central)  = ka * depot - ke * central -        k12 * central +        k21 * peripheral     d/dt(peripheral) = k12 * central -        k21 * peripheral          # Concentration in the central compartment     cp = central / v1   })    # Generate covariates   theta <- c(cl=5, v1 = 10, v2 =30, q =10, ka = 1)    omegaCor <- matrix(c(1,  0,  0,  0,  0,                        0,  1,  0,  0,  0,                        0,  0,  1,  0,  0,                        0,  0,  0,  1,  0,                        0,  0,  0,  0,  1),                       dimnames=list(NULL,c(\"eta.cl\",\"eta.v1\",\"eta.v2\", \"eta.q\",                                            \"eta.ka\")), nrow=5)    iiv.sd <- c(0.3, 0.3, 0.3, 0.3, 0.3) ## SDs of model parameters    iiv <- iiv.sd %*% t(iiv.sd)   omega <- iiv * omegaCor  # covariance matrix    mv <- mvrnorm(n, rep(0, dim(omega)[1]), omega)    params.all <-     data.table(       \"ID\" = seq(1:n),       \"cl\" = theta['cl'] * exp(mv[, 1]),       \"v1\" = theta['v1'] * exp(mv[, 2]),       \"v2\" = theta['v2'] * exp(mv[, 3]),       \"q\"  = theta['q']  * exp(mv[, 4]),       \"ka\" = theta['ka'] * exp(mv[, 5])     )    # Event table   ev <- et() %>%     et(amt = 100) %>%  # Add single dose     et(0) %>%  # Add initial time observation     et(times) %>%  # Sampling schedule     et(ID = seq(1, n)) %>%  # Assign unique IDs for all subjects     as.data.frame()    # Solve the model   sim <- rxSolve(mod, events = ev, iCov = params.all, cores = 0, addCov = T) %>%     mutate(ID = as.integer(id), TIME = as.numeric(time)) %>%     dplyr::select(-c(id, time)) %>%     mutate(AMT =  ifelse(TIME == 0, 100, 0)) %>%     mutate(EVID = ifelse(TIME == 0, 101, 0)) %>%     mutate(CMT = ifelse(TIME == 0, 1, 2))    # Simulate residual error and combine   sim$rv <- rnorm(nrow(sim), 0, 0.2)   sim$DV <- round(sim$cp * (1 + sim$rv), 3)   sim <- merge(sim, params.all)    dat <- sim %>%     dplyr::select(\"ID\", \"TIME\", \"DV\", \"AMT\", \"EVID\", \"CMT\")    return(dat) }"},{"path":"https://hiddevandebeek.github.io/admr/articles/examplomycin.html","id":"generating-the-examplomycin-dataset","dir":"Articles","previous_headings":"Creating the examplomycin dataset","what":"Generating the examplomycin dataset","title":"Examplomycin dataset","text":"now generate examplomycin dataset 500 subjects 9 timepoints . use random seed 1 reproducibility.","code":"examplomycin <- generate_data(n = 500, times = c(.1,.25,.5,1,2,3,5,8,12),                                seed = 1) ## using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’ head(examplomycin) ##    ID TIME    DV AMT EVID CMT ## 1 460 0.00 0.000 100  101   1 ## 2 460 0.10 0.752   0    0   2 ## 3 460 0.25 1.932   0    0   2 ## 4 460 0.50 3.694   0    0   2 ## 5 460 1.00 3.479   0    0   2 ## 6 460 2.00 4.003   0    0   2"},{"path":"https://hiddevandebeek.github.io/admr/articles/examplomycin.html","id":"plotting-the-examplomycin-dataset","dir":"Articles","previous_headings":"Creating the examplomycin dataset","what":"Plotting the examplomycin dataset","title":"Examplomycin dataset","text":"now create concentration-time plot examplomycin dataset. line represents different subject, points represent observed concentrations timepoint. color lines corresponds subject ID.","code":"# Basic concentration-time plot ggplot(examplomycin, aes(x = TIME, y = DV, color = factor(ID))) +   geom_line(alpha = 0.7) +    # Lines connecting points   geom_point(size = 2, alpha = 0.8) +  # Points for observations   scale_color_viridis_d(name = \"Subject ID\") +  # Color by subject ID   labs(     title = \"Concentration-Time Profile\",     x = \"Time (hours)\",     y = \"Observed Concentration (DV)\"   ) + # y log scale   theme_minimal() +   theme(legend.position = \"none\")  # Hide legend if too many subjects"},{"path":"https://hiddevandebeek.github.io/admr/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"H. van de Beek. Maintainer.","code":""},{"path":"https://hiddevandebeek.github.io/admr/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"van de Beek H, Välitalo P, Zwep L, van Hasselt J (2025). admr: Aggregate data modelling R. R package version 0.1.0, https://hiddevandebeek.github.io/admr/, https://hiddevandebeek.github.io/admr.","code":"@Manual{,   title = {admr: Aggregate data modelling in R},   author = {H. {van de Beek} and P.A.J. Välitalo and L.B. Zwep and J.G.C {van Hasselt}},   year = {2025},   note = {R package version 0.1.0, https://hiddevandebeek.github.io/admr/},   url = {https://hiddevandebeek.github.io/admr}, }"},{"path":"https://hiddevandebeek.github.io/admr/index.html","id":"admr-aggregate-data-modeling-in-r","dir":"","previous_headings":"","what":"Aggregate data modelling in R","title":"Aggregate data modelling in R","text":"admr (Aggregate Data Modeling R) open-source R package designed facilitate pharmacometric modeling using summary-level data. enables users work aggregate data, mean observations variance-covariance matrices, fit pharmacokinetic pharmacodynamic (PK/PD) models efficiently. package implements newly developed Expectation-Maximization (EM) algorithm enhance computational performance provides tools advanced modeling applications. Features Expectation-Maximization Algorithm: Efficiently fits pharmacometric models aggregate data, improving speed scalability compared Monte Carlo methods. Aggregate Data Flexibility: Allows integration summary-level data diverse sources, including published literature simulated models. Meta-Analysis Support: Facilitates model-based meta-analyses enabling combination summary data across studies. R Integration: Fully compatible R, leveraging popular pharmacometric modeling libraries like rxode2. Open-Source: Developed accessibility ease use pharmacometric community.","code":""},{"path":"https://hiddevandebeek.github.io/admr/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Aggregate data modelling in R","text":"R package. R required, RStudio recommended. can install development version admr GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"hiddevandebeek/admr\")"},{"path":"https://hiddevandebeek.github.io/admr/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Aggregate data modelling in R","text":"basic example use admr fit pharmacokinetic model aggregate data:","code":"library(admr) ## basic example code"},{"path":"https://hiddevandebeek.github.io/admr/reference/admr-package.html","id":null,"dir":"Reference","previous_headings":"","what":"admr: Aggregate data modelling in R — admr-package","title":"admr: Aggregate data modelling in R — admr-package","text":"novel method aggregate data model using non-linear estimation techniques.","code":""},{"path":[]},{"path":"https://hiddevandebeek.github.io/admr/reference/admr-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"admr: Aggregate data modelling in R — admr-package","text":"H. van de Beek P..J. Välitalo","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/examplomycin.html","id":null,"dir":"Reference","previous_headings":"","what":"Examplomycin Dataset — examplomycin","title":"Examplomycin Dataset — examplomycin","text":"simulated dataset fictional drug examplomycin. dataset contains 500 subjects, 9 timepoints. generated using two-compartment pharmacokinetic model first-order absorption elimination. Random effects residual errors included simulate variability noise.","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/examplomycin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Examplomycin Dataset — examplomycin","text":"","code":"examplomycin"},{"path":"https://hiddevandebeek.github.io/admr/reference/examplomycin.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Examplomycin Dataset — examplomycin","text":"data frame 4500 rows 6 variables: ID: Subject ID. TIME: Observation time (hours). DV: Observed drug concentration (mg/L). AMT: Amount drug administered (mg). EVID: Event type indicator (0 observation, 101 dosing). CMT: Compartment number (1 depot, 2 central).","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/examplomycin.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Examplomycin Dataset — examplomycin","text":"Generated using generate_data function.","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/examplomycin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Examplomycin Dataset — examplomycin","text":"","code":"# Load the dataset data(\"examplomycin\")  # View the first few rows head(examplomycin) #>    ID TIME    DV AMT EVID CMT #> 1 460 0.00 0.000 100  101   1 #> 2 460 0.10 0.752   0    0   2 #> 3 460 0.25 1.932   0    0   2 #> 4 460 0.50 3.694   0    0   2 #> 5 460 1.00 3.479   0    0   2 #> 6 460 2.00 4.003   0    0   2"},{"path":"https://hiddevandebeek.github.io/admr/reference/fitEM.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitting aggregate data — fitEM","title":"Fitting aggregate data — fitEM","text":"fitEM() implements Expectation-Maximization(EM) algorithm parameter estimation given aggregate data model, iterating maximum likelihood updates weighted MC updates. version function uses nloptr instead optimx. TOL = 1e-10","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/fitEM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitting aggregate data — fitEM","text":"","code":"fitEM(   opts,   obs,   maxiter = 100,   convcrit_nll = 1e-05,   single_dataframe = TRUE,   phase_fractions = c(0.2, 0.4, 0.2, 0.2),   max_worse_iterations = 10,   chains = 1,   pertubation = 0.1,   seed = 1 )"},{"path":"https://hiddevandebeek.github.io/admr/reference/fitEM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitting aggregate data — fitEM","text":"opts options obs observed data maxiter maximum number iterations convcrit_nll convergence criterion negative log-likelihood single_dataframe single model multiple models phase_fractions vector phase fractions max_worse_iterations maximum number consecutive worse iterations skipping phase chains number chains pertubation pertubation factor initial parameter values chain seed random seed","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/fitEM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitting aggregate data — fitEM","text":"fitted model","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/fitEM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fitting aggregate data — fitEM","text":"","code":"#test"},{"path":"https://hiddevandebeek.github.io/admr/reference/gendataset.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a dataset — gendataset","title":"Generate a dataset — gendataset","text":"gendataset() generates dataset based model structure random effects, optional residual error.","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/gendataset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a dataset — gendataset","text":"","code":"gendataset(opts, seed = 1, reserr = TRUE, nlmixrform = FALSE)"},{"path":"https://hiddevandebeek.github.io/admr/reference/gendataset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a dataset — gendataset","text":"opts list options seed seed random number generator reserr logical indicating whether residual error added nlmixrform logical indicating whether dataset nlmixr format","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/gendataset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a dataset — gendataset","text":"dataset","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/gendataset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a dataset — gendataset","text":"","code":"#test"},{"path":"https://hiddevandebeek.github.io/admr/reference/genfitfunc.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a fitting function for optimization — genfitfunc","title":"Generate a fitting function for optimization — genfitfunc","text":"genfitfunc() generates fitting function optimization, taking observed data model options inputs.","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/genfitfunc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a fitting function for optimization — genfitfunc","text":"","code":"genfitfunc(opts, obs)"},{"path":"https://hiddevandebeek.github.io/admr/reference/genfitfunc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a fitting function for optimization — genfitfunc","text":"opts model options obs observed data","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/genfitfunc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a fitting function for optimization — genfitfunc","text":"fitting function","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/genfitfunc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a fitting function for optimization — genfitfunc","text":"","code":"#test"},{"path":"https://hiddevandebeek.github.io/admr/reference/genopts.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate options for optimization — genopts","title":"Generate options for optimization — genopts","text":"genopts() initializes generates core options settings modeling optimization, including random effects, simulation settings, likelihood approximations.","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/genopts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate options for optimization — genopts","text":"","code":"genopts(   f,   time,   p,   h,   nsim = 1,   n = 30,   adist = NULL,   interact = TRUE,   fo_appr = (nsim < 10),   biseq = NA,   omega_expansion = 1,   single_betas = NA )"},{"path":"https://hiddevandebeek.github.io/admr/reference/genopts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate options for optimization — genopts","text":"f likelihood function time data p parameter settings h error function nsim number simulations n number simulations adist distribution random effects interact Whether include interaction terms fo_appr Whether use first-order approximation biseq sequence random effects omega_expansion expansion factor omega matrix single_betas beta matrix","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/genopts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate options for optimization — genopts","text":"fitted model","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/genopts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate options for optimization — genopts","text":"","code":"#test"},{"path":"https://hiddevandebeek.github.io/admr/reference/meancov.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate options for optimization — meancov","title":"Generate options for optimization — meancov","text":"meancov() computes mean covariance matrix, optionally weights.","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/meancov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate options for optimization — meancov","text":"","code":"meancov(m, wt)"},{"path":"https://hiddevandebeek.github.io/admr/reference/meancov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate options for optimization — meancov","text":"m matrix wt weights","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/meancov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate options for optimization — meancov","text":"list mean covariance","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/meancov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate options for optimization — meancov","text":"","code":"#test"},{"path":"https://hiddevandebeek.github.io/admr/reference/omegas.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a dataset — omegas","title":"Generate a dataset — omegas","text":"omegas() creates matrix specified diagonal -diagonal values.","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/omegas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a dataset — omegas","text":"","code":"omegas(diag, offdiag, n_om)"},{"path":"https://hiddevandebeek.github.io/admr/reference/omegas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a dataset — omegas","text":"diag value diagonal offdiag value -diagonal n_om size matrix","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/omegas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a dataset — omegas","text":"matrix specified diagonal -diagonal values.","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/omegas.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a dataset — omegas","text":"","code":"#test"},{"path":"https://hiddevandebeek.github.io/admr/reference/p_to_optim.html","id":null,"dir":"Reference","previous_headings":"","what":"Parameters to optimizable form — p_to_optim","title":"Parameters to optimizable form — p_to_optim","text":"p_to_optim() Converts parameter list form can optimized, returning transformed values, back-transformation functions, derivatives.","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/p_to_optim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parameters to optimizable form — p_to_optim","text":"","code":"p_to_optim(p)"},{"path":"https://hiddevandebeek.github.io/admr/reference/p_to_optim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parameters to optimizable form — p_to_optim","text":"p parameter list","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/p_to_optim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parameters to optimizable form — p_to_optim","text":"optimized parameter list","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/p_to_optim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parameters to optimizable form — p_to_optim","text":"","code":"#test"},{"path":"https://hiddevandebeek.github.io/admr/reference/plot.fitEM_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot diagnostics of fitEM results — plot.fitEM_result","title":"Plot diagnostics of fitEM results — plot.fitEM_result","text":"Plot diagnostics fitEM results","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/plot.fitEM_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot diagnostics of fitEM results — plot.fitEM_result","text":"","code":"# S3 method for class 'fitEM_result' plot(x, ...)"},{"path":"https://hiddevandebeek.github.io/admr/reference/plot.fitEM_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot diagnostics of fitEM results — plot.fitEM_result","text":"x fitted model object returned fitEM ... Additional arguments (used)","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/print.fitEM_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Print fitEM results — print.fitEM_result","title":"Print fitEM results — print.fitEM_result","text":"Print fitEM results","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/print.fitEM_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print fitEM results — print.fitEM_result","text":"","code":"# S3 method for class 'fitEM_result' print(x, ...)"},{"path":"https://hiddevandebeek.github.io/admr/reference/print.fitEM_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print fitEM results — print.fitEM_result","text":"x fitted model object returned fitEM ... Additional arguments (used)","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/timedEM.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitting aggregate data — timedEM","title":"Fitting aggregate data — timedEM","text":"timedEM() implements Expectation-Maximization(EM) algorithm parameter estimation given aggregate data model, iterating maximum likelihood updates weighted MC updates. used compare performance old new implementation aggregate data modelling.","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/timedEM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitting aggregate data — timedEM","text":"","code":"timedEM(init, opts, obs, maxiter = 100, convcrit_nll = 5e-04, nomap = TRUE)"},{"path":"https://hiddevandebeek.github.io/admr/reference/timedEM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitting aggregate data — timedEM","text":"init initial parameter values opts options obs observed data maxiter maximum number iterations convcrit_nll convergence criterion negative log-likelihood nomap single model multiple models","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/timedEM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitting aggregate data — timedEM","text":"fitted model","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/timedEM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fitting aggregate data — timedEM","text":"","code":"#test"},{"path":"https://hiddevandebeek.github.io/admr/reference/timedbobyqa.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitting aggregate data — timedbobyqa","title":"Fitting aggregate data — timedbobyqa","text":"timedbobyqa() implements bobqa algorithm parameter estimation given aggregate data model, iterating maximum likelihood updates MC updates. iteration creates new MC samples updates parameter values. used compare performance old new implementation aggregate data modelling.","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/timedbobyqa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitting aggregate data — timedbobyqa","text":"","code":"timedbobyqa(p0, opts, obs)"},{"path":"https://hiddevandebeek.github.io/admr/reference/timedbobyqa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitting aggregate data — timedbobyqa","text":"p0 initial parameter values opts options obs observed data","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/timedbobyqa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitting aggregate data — timedbobyqa","text":"fitted model","code":""},{"path":"https://hiddevandebeek.github.io/admr/reference/timedbobyqa.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fitting aggregate data — timedbobyqa","text":"","code":"#test"},{"path":"https://hiddevandebeek.github.io/admr/news/index.html","id":"admr-010","dir":"Changelog","previous_headings":"","what":"admr 0.1.0","title":"admr 0.1.0","text":"Initial CRAN submission.","code":""}]
