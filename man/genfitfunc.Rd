% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/genfitfunc.R
\name{genfitfunc}
\alias{genfitfunc}
\title{Generate a fitting function for optimization}
\usage{
genfitfunc(opts, obs)
}
\arguments{
\item{opts}{A list of model options generated by \code{genopts()}. Contains settings for the model,
including the prediction function, time points, parameter structure, and simulation
settings.}

\item{obs}{Observed data in aggregate form (mean and covariance) or as a matrix of raw data.
If missing, the expected data from the model is used.}
}
\value{
A function that takes parameter values as input and returns the negative log-likelihood
of the model given the observed data. The function signature is:
\verb{function(p) -> numeric}
}
\description{
\code{genfitfunc} generates a fitting function for optimization that computes the negative
log-likelihood of the model given the observed data and current parameter estimates.
The function handles both raw data and aggregate data (mean and covariance) formats.
}
\details{
The generated fitting function:
\itemize{
\item Computes the expected mean and covariance of the model predictions
\item Compares these with the observed data
\item Returns the negative log-likelihood of the model
}

If raw data is provided, it is automatically converted to aggregate form (mean and covariance)
using the \code{meancov} function. The function handles both single models and multiple models
(when \code{opts} is a list of model options).
}
\examples{
# Create test data
test_data <- create_test_data()
opts <- test_data$opts
obs <- test_data$obs

# Generate fitting function
fitfun <- genfitfunc(opts, obs)

# Evaluate at initial parameters
nll <- fitfun(opts$pt)

}
