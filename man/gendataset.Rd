% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gendataset.R
\name{gendataset}
\alias{gendataset}
\title{Generate a simulated dataset}
\usage{
gendataset(opts, seed = 1, reserr = TRUE, nlmixrform = FALSE)
}
\arguments{
\item{opts}{A list of model options generated by \code{genopts()}. Contains settings for the model,
including the prediction function, time points, parameter structure, and simulation
settings.}

\item{seed}{Random seed for reproducibility. Default is 1.}

\item{reserr}{Logical indicating whether to add residual error to the simulated data.
Default is TRUE.}

\item{nlmixrform}{Logical indicating whether to return the data in nlmixr format.
If TRUE, returns a data frame with columns: dv, time, id, amt, evid, cmt.
If FALSE, returns a matrix of simulated observations.
Default is FALSE.}
}
\value{
If \code{nlmixrform} is FALSE, returns a matrix of simulated observations with dimensions
\code{nsim} x \code{length(time)}. If \code{nlmixrform} is TRUE, returns a data frame in nlmixr
format with columns:
\itemize{
\item \code{dv}: Observed value
\item \code{time}: Observation time
\item \code{id}: Subject ID
\item \code{amt}: Dose amount (NA for observations)
\item \code{evid}: Event type (101 for dosing, 0 for observation)
\item \code{cmt}: Compartment number (1 for depot, 2 for central)
}
}
\description{
\code{gendataset} generates a simulated dataset based on the model structure and random effects
specified in the options. The function can generate data in either raw format or nlmixr format,
with optional residual error.
}
\details{
The function generates simulated data by:
\itemize{
\item Generating random effects from the specified distribution
\item Computing individual parameters using the transformation function
\item Simulating observations using the prediction function
\item Adding residual error if requested
\item Formatting the output according to the specified format
}

The residual error can be either proportional (Sigma_prop) or additive (Sigma_add), or both.
The function uses the random number generator seed to ensure reproducibility.
}
\examples{
# Create model options
opts <- genopts(
  f = predder,
  time = c(.1, .25, .5, 1, 2, 3, 5, 8, 12),
  p = list(
    beta = c(cl = 5, v1 = 10, v2 = 30, q = 10, ka = 1),
    Omega = matrix(c(0.09, 0, 0, 0, 0,
                    0, 0.09, 0, 0, 0,
                    0, 0, 0.09, 0, 0,
                    0, 0, 0, 0.09, 0,
                    0, 0, 0, 0, 0.09), nrow = 5, ncol = 5),
    Sigma_prop = 0.04
  ),
  nsim = 2500,
  n = 500
)

# Generate dataset in raw format
data_raw <- gendataset(opts)

# Generate dataset in nlmixr format
data_nlmixr <- gendataset(opts, nlmixrform = TRUE)

}
