<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>admr • admr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="admr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">admr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/admr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/examplomycin.html">examplomycin</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hiddevandebeek/admr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>admr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/hiddevandebeek/admr/blob/HEAD/vignettes/admr.Rmd" class="external-link"><code>vignettes/admr.Rmd</code></a></small>
      <div class="d-none name"><code>admr.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="example-of-using-admr-with-rxode2">Example of using <code>admr</code> with <code>rxode2</code><a class="anchor" aria-label="anchor" href="#example-of-using-admr-with-rxode2"></a>
</h2>
<p>Import the <code>admr</code> and other packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hiddevandebeek.github.io/admr">admr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/rxode2/" class="external-link">rxode2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.org/" class="external-link">nlmixr2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mnorm</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">examplomycin</span><span class="op">)</span></span>
<span><span class="co">#&gt;    ID TIME    DV AMT EVID CMT</span></span>
<span><span class="co">#&gt; 1 460 0.00 0.000 100  101   1</span></span>
<span><span class="co">#&gt; 2 460 0.10 0.752   0    0   2</span></span>
<span><span class="co">#&gt; 3 460 0.25 1.932   0    0   2</span></span>
<span><span class="co">#&gt; 4 460 0.50 3.694   0    0   2</span></span>
<span><span class="co">#&gt; 5 460 1.00 3.479   0    0   2</span></span>
<span><span class="co">#&gt; 6 460 2.00 4.003   0    0   2</span></span></code></pre></div>
<p>In this scenario, we will use the <code>examplomycin</code> dataset
to demonstrate how to use the <code>admr</code> package with the
<code>rxode2</code> package. We show how to manipulate the dataset to
get it in the right format for the <code>admr</code> package. In future
scenarios, we might not have access to an individual dataset, but this
vignette demonstrates the right format.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">examplomycin_wide</span> <span class="op">&lt;-</span> <span class="va">examplomycin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EVID</span> <span class="op">!=</span> <span class="fl">101</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">TIME</span>, <span class="va">DV</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="co"># Select only the relevant columns</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">TIME</span>, values_from <span class="op">=</span> <span class="va">DV</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">examplomycin_aggregated</span> <span class="op">&lt;-</span> <span class="va">examplomycin_wide</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">admr</span><span class="fu">::</span><span class="fu"><a href="../reference/meancov.html">meancov</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">examplomycin_aggregated</span><span class="op">)</span></span>
<span><span class="co">#&gt; $E</span></span>
<span><span class="co">#&gt;      0.1     0.25      0.5        1        2        3        5        8 </span></span>
<span><span class="co">#&gt; 0.966418 1.938774 2.787908 3.024706 2.257656 1.650808 1.063120 0.751180 </span></span>
<span><span class="co">#&gt;       12 </span></span>
<span><span class="co">#&gt; 0.512168 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $V</span></span>
<span><span class="co">#&gt;               0.1         0.25         0.5           1          2           3</span></span>
<span><span class="co">#&gt; 0.1   0.210318331  0.307810566  0.34863077 0.202610737 0.02244783 -0.04472722</span></span>
<span><span class="co">#&gt; 0.25  0.307810566  0.707512991  0.65887098 0.416118052 0.05871261 -0.07441765</span></span>
<span><span class="co">#&gt; 0.5   0.348630772  0.658870977  1.09983366 0.530554165 0.10572618 -0.07538386</span></span>
<span><span class="co">#&gt; 1     0.202610737  0.416118052  0.53055416 0.803744604 0.16252833  0.02792441</span></span>
<span><span class="co">#&gt; 2     0.022447834  0.058712608  0.10572618 0.162528331 0.34465070  0.12026872</span></span>
<span><span class="co">#&gt; 3    -0.044727222 -0.074417647 -0.07538386 0.027924410 0.12026872  0.24989260</span></span>
<span><span class="co">#&gt; 5    -0.018976800 -0.042420657 -0.04648286 0.001618855 0.07644080  0.11148574</span></span>
<span><span class="co">#&gt; 8    -0.006630907 -0.011273701 -0.01981830 0.016197981 0.06398700  0.07493319</span></span>
<span><span class="co">#&gt; 12   -0.005625994 -0.005018766 -0.01492001 0.014748325 0.04941463  0.05460018</span></span>
<span><span class="co">#&gt;                 5            8           12</span></span>
<span><span class="co">#&gt; 0.1  -0.018976800 -0.006630907 -0.005625994</span></span>
<span><span class="co">#&gt; 0.25 -0.042420657 -0.011273701 -0.005018766</span></span>
<span><span class="co">#&gt; 0.5  -0.046482865 -0.019818299 -0.014920009</span></span>
<span><span class="co">#&gt; 1     0.001618855  0.016197981  0.014748325</span></span>
<span><span class="co">#&gt; 2     0.076440801  0.063987002  0.049414630</span></span>
<span><span class="co">#&gt; 3     0.111485737  0.074933189  0.054600176</span></span>
<span><span class="co">#&gt; 5     0.154215442  0.087680168  0.061332530</span></span>
<span><span class="co">#&gt; 8     0.087680168  0.096530356  0.057621124</span></span>
<span><span class="co">#&gt; 12    0.061332530  0.057621124  0.057988752</span></span></code></pre></div>
<div class="section level3">
<h3 id="defining-the-rxode-model">Defining the RxODE model<a class="anchor" aria-label="anchor" href="#defining-the-rxode-model"></a>
</h3>
<p>We will define a two-compartment model for the examplomycin dataset.
The model has the following differential equations:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rxModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/rxode2.html" class="external-link">RxODE</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="co"># Parameters</span></span>
<span>  <span class="va">ke</span> <span class="op">=</span> <span class="va">cl</span> <span class="op">/</span> <span class="va">v1</span>             <span class="co"># Elimination rate constant</span></span>
<span>  <span class="va">k12</span> <span class="op">=</span> <span class="va">q</span> <span class="op">/</span> <span class="va">v1</span>             <span class="co"># Rate constant for central to peripheral transfer</span></span>
<span>  <span class="va">k21</span> <span class="op">=</span> <span class="va">q</span> <span class="op">/</span> <span class="va">v2</span>             <span class="co"># Rate constant for peripheral to central transfer</span></span>
<span>  </span>
<span>  <span class="co"># Differential equations for drug amount in compartments</span></span>
<span>  <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span>    <span class="op">=</span> <span class="op">-</span><span class="va">ka</span> <span class="op">*</span> <span class="va">depot</span></span>
<span>  <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">central</span><span class="op">)</span>  <span class="op">=</span> <span class="va">ka</span> <span class="op">*</span> <span class="va">depot</span> <span class="op">-</span> <span class="va">ke</span> <span class="op">*</span> <span class="va">central</span> <span class="op">-</span> <span class="va">k12</span> <span class="op">*</span> <span class="va">central</span> <span class="op">+</span> <span class="va">k21</span> <span class="op">*</span> <span class="va">peripheral</span></span>
<span>  <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">peripheral</span><span class="op">)</span> <span class="op">=</span> <span class="va">k12</span> <span class="op">*</span> <span class="va">central</span> <span class="op">-</span> <span class="va">k21</span> <span class="op">*</span> <span class="va">peripheral</span></span>
<span>  </span>
<span>  <span class="co"># Concentration in the central compartment</span></span>
<span>  <span class="va">cp</span> <span class="op">=</span> <span class="va">central</span> <span class="op">/</span> <span class="va">v1</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>A solved model is available for the two-compartment model, speeding
up the simulation process. The <code>linCmt</code> function has multiple
solved models. The function takes the following arguments:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rxModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/rxode2.html" class="external-link">RxODE</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">cp</span> <span class="op">=</span> <span class="fu">linCmt</span><span class="op">(</span>    <span class="co"># Solved one- or two-compartment model</span></span>
<span>    <span class="va">cl</span>,           <span class="co"># Clearance</span></span>
<span>    <span class="va">v1</span>,           <span class="co"># Volume of the central compartment</span></span>
<span>    <span class="va">v2</span>,           <span class="co"># Volume of the peripheral compartment</span></span>
<span>    <span class="va">q</span>,            <span class="co"># Inter-compartmental clearance</span></span>
<span>    <span class="va">ka</span>            <span class="co"># Absorption rate constant</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="defining-the-prediction-function">Defining the prediction function<a class="anchor" aria-label="anchor" href="#defining-the-prediction-function"></a>
</h3>
<p>This is necessary for the <code>admr</code> package to simulate the
model. Tt constructs the event table for dosing and sampling, solves the
RxODE model, and extracts the predicted concentrations. The function can
handle both single and multiple individuals. The <code>twocomp_g</code>
function is the g function for the two-compartment model.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predder</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">time</span>, <span class="va">theta_i</span>, <span class="va">dose</span> <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">is.matrix</a></span><span class="op">(</span><span class="va">theta_i</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">theta_i</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Create the event table for dosing and sampling</span></span>
<span>    <span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu">rxode2</span><span class="fu">::</span><span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/eventTable.html" class="external-link">eventTable</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">ev</span><span class="op">$</span><span class="fu">add.dosing</span><span class="op">(</span>dose <span class="op">=</span> <span class="va">dose</span>, nbr.doses <span class="op">=</span> <span class="fl">1</span>, start.time <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>  <span class="co"># Single dose</span></span>
<span>    <span class="va">ev</span><span class="op">$</span><span class="fu">add.sampling</span><span class="op">(</span><span class="va">time</span><span class="op">)</span>  <span class="co"># Time points to simulate</span></span>
<span>    </span>
<span>    <span class="co"># Solve the RxODE model</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/rxSolve.html" class="external-link">rxSolve</a></span><span class="op">(</span><span class="va">rxModel</span>, <span class="va">theta_i</span>, events <span class="op">=</span> <span class="va">ev</span>, cores <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Extract the predicted concentrations (cp)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">cp</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="co"># Multiple individuals case</span></span>
<span>    <span class="va">n_individuals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">theta_i</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Create the event table for dosing and sampling</span></span>
<span>    <span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/eventTable.html" class="external-link">eventTable</a></span><span class="op">(</span>amount.units<span class="op">=</span><span class="st">"mg"</span>, time.units<span class="op">=</span><span class="st">"hours"</span><span class="op">)</span></span>
<span>    <span class="va">ev</span><span class="op">$</span><span class="fu">add.dosing</span><span class="op">(</span>dose <span class="op">=</span> <span class="va">dose</span>, nbr.doses <span class="op">=</span> <span class="fl">1</span>, start.time <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>  <span class="co"># Assume same dose</span></span>
<span>    <span class="va">ev</span><span class="op">$</span><span class="fu">add.sampling</span><span class="op">(</span><span class="va">time</span><span class="op">)</span>  <span class="co"># Time points to simulate</span></span>
<span>    </span>
<span>    <span class="co"># Solve the RxODE model for all individuals</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2/reference/rxSolve.html" class="external-link">rxSolve</a></span><span class="op">(</span><span class="va">rxModel</span>, params <span class="op">=</span> <span class="va">theta_i</span>, events <span class="op">=</span> <span class="va">ev</span>, cores <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Extract the predicted concentrations (cp) and format them as a matrix</span></span>
<span>    <span class="va">cp_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">cp</span>, nrow <span class="op">=</span> <span class="va">n_individuals</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, </span>
<span>                        byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Return matrix of predicted concentrations</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">cp_matrix</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">twocomp_g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">beta</span>,<span class="va">bi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span>,<span class="va">ai</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">beta</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">bi</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This opts object contains the options for the <code>admr</code>
package. The <code>genopts</code> function generates the options object.
IT</p>
<p>The <code>fitEM</code> function fits the model to the dataset.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genopts.html">genopts</a></span><span class="op">(</span>time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.25</span>,<span class="fl">.5</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">12</span><span class="op">)</span>,</span>
<span>                  p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>cl <span class="op">=</span> <span class="fl">5</span>, v1 <span class="op">=</span> <span class="fl">10</span>, v2 <span class="op">=</span> <span class="fl">30</span>,q <span class="op">=</span> <span class="fl">10</span>, ka <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                  Omega<span class="op">=</span><span class="fu"><a href="../reference/omegas.html">omegas</a></span><span class="op">(</span><span class="fl">.09</span>,<span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,Sigma_prop<span class="op">=</span><span class="fl">0.04</span><span class="op">)</span>,</span>
<span>                  nsim<span class="op">=</span><span class="fl">2500</span>,n<span class="op">=</span><span class="fl">500</span>,adist<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                  g <span class="op">=</span> <span class="va">twocomp_g</span>,</span>
<span>                  interact<span class="op">=</span><span class="cn">TRUE</span>,fo_appr<span class="op">=</span><span class="cn">FALSE</span>,biseq<span class="op">=</span><span class="cn">NA</span>,omega_expansion<span class="op">=</span><span class="fl">1.2</span>,</span>
<span>                  p_thetai<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">p</span>,<span class="va">origbeta</span>,<span class="va">bi</span><span class="op">)</span> <span class="op">{</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/pkg/mnorm/man/dmnorm.html" class="external-link">dmnorm</a></span><span class="op">(</span><span class="va">bi</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">beta</span><span class="op">/</span><span class="va">origbeta</span><span class="op">)</span>,</span>
<span>                           sigma<span class="op">=</span><span class="va">p</span><span class="op">$</span><span class="va">Omega</span>,log<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">den</span><span class="op">}</span>,</span>
<span>                  f<span class="op">=</span><span class="va">predder</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitEM.html">fitEM</a></span><span class="op">(</span><span class="va">opts</span>, <span class="va">examplomycin_aggregated</span>, chains <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Chain 1:</span></span>
<span><span class="co">#&gt; Iter | NLL and Parameters (11 values)</span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;    1: -1839.577    1.609    2.303    3.401    2.303    0.000   -2.408   -2.408   -2.408   -2.408   -2.408   -3.219</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Exploration Phase ###</span></span>
<span><span class="co">#&gt;    2: -1845.238    1.601    2.309    3.404    2.284    0.020   -2.279   -2.167   -2.333   -2.245   -2.439   -3.235</span></span>
<span><span class="co">#&gt;    3: -1845.273    1.600    2.306    3.406    2.284    0.017   -2.286   -2.191   -2.338   -2.271   -2.422   -3.235</span></span>
<span><span class="co">#&gt;    4: -1845.276    1.601    2.306    3.405    2.285    0.017   -2.286   -2.194   -2.344   -2.266   -2.418   -3.235</span></span>
<span><span class="co">#&gt;    5: -1845.276    1.601    2.306    3.405    2.285    0.017   -2.286   -2.194   -2.344   -2.266   -2.418   -3.235</span></span>
<span><span class="co">#&gt;    6: -1845.276    1.600    2.306    3.405    2.285    0.017   -2.286   -2.194   -2.344   -2.266   -2.417   -3.235</span></span>
<span><span class="co">#&gt;    7: -1845.276    1.600    2.306    3.405    2.285    0.017   -2.286   -2.194   -2.344   -2.265   -2.417   -3.235</span></span>
<span><span class="co">#&gt;    8: -1845.277    1.600    2.306    3.405    2.285    0.017   -2.286   -2.195   -2.344   -2.266   -2.417   -3.235</span></span>
<span><span class="co">#&gt;    9: -1845.277    1.601    2.306    3.405    2.285    0.017   -2.286   -2.195   -2.344   -2.265   -2.417   -3.235</span></span>
<span><span class="co">#&gt;   10: -1845.277    1.600    2.306    3.405    2.285    0.017   -2.286   -2.196   -2.343   -2.265   -2.416   -3.235</span></span>
<span><span class="co">#&gt;   11: -1845.277    1.600    2.306    3.405    2.285    0.017   -2.286   -2.196   -2.344   -2.265   -2.416   -3.235</span></span>
<span><span class="co">#&gt; Phase Exploration Phase converged at iteration 11. </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Refinement Phase ###</span></span>
<span><span class="co">#&gt;   12: -1845.279    1.601    2.307    3.405    2.285    0.018   -2.286   -2.199   -2.343   -2.264   -2.412   -3.235</span></span>
<span><span class="co">#&gt;   13: -1845.279    1.601    2.307    3.405    2.285    0.018   -2.286   -2.199   -2.343   -2.264   -2.412   -3.235</span></span>
<span><span class="co">#&gt;   14: -1845.279    1.601    2.307    3.405    2.285    0.018   -2.286   -2.199   -2.343   -2.264   -2.412   -3.235</span></span>
<span><span class="co">#&gt;   15: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.199   -2.343   -2.264   -2.412   -3.235</span></span>
<span><span class="co">#&gt;   16: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.199   -2.343   -2.264   -2.411   -3.235</span></span>
<span><span class="co">#&gt;   17: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.200   -2.343   -2.264   -2.411   -3.235</span></span>
<span><span class="co">#&gt;   18: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.200   -2.343   -2.264   -2.411   -3.235</span></span>
<span><span class="co">#&gt;   19: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.200   -2.343   -2.264   -2.411   -3.235</span></span>
<span><span class="co">#&gt;   20: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.200   -2.343   -2.264   -2.411   -3.235</span></span>
<span><span class="co">#&gt; Phase Refinement Phase converged at iteration 20. </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Final Phase ###</span></span>
<span><span class="co">#&gt;   21: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.200   -2.343   -2.264   -2.411   -3.235</span></span>
<span><span class="co">#&gt;   22: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.200   -2.343   -2.265   -2.411   -3.235</span></span>
<span><span class="co">#&gt;   23: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.200   -2.343   -2.265   -2.411   -3.235</span></span>
<span><span class="co">#&gt;   24: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.200   -2.343   -2.265   -2.411   -3.235</span></span>
<span><span class="co">#&gt; Phase Final Phase converged at iteration 24. </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Final Phase 2 ###</span></span>
<span><span class="co">#&gt;   25: -1845.280    1.601    2.307    3.405    2.285    0.018   -2.286   -2.200   -2.343   -2.265   -2.411   -3.235</span></span>
<span><span class="co">#&gt; Phase Final Phase 2 converged at iteration 25. </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Chain 1 Complete: Final NLL = -1845.280, Time Elapsed = 7.70 seconds</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Phase Exploration Phase converged at iteration 11. </span></span>
<span><span class="co">#&gt; Phase Refinement Phase converged at iteration 12. </span></span>
<span><span class="co">#&gt; Phase Final Phase converged at iteration 17. </span></span>
<span><span class="co">#&gt; Phase Final Phase 2 converged at iteration 23. </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Chain 2 Complete: Final NLL = -1845.282, Time Elapsed = 8.33 seconds</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Phase Exploration Phase converged at iteration 5. </span></span>
<span><span class="co">#&gt; Phase Refinement Phase converged at iteration 11. </span></span>
<span><span class="co">#&gt; Phase Final Phase converged at iteration 17. </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Chain 3 Complete: Final NLL = -1845.284, Time Elapsed = 10.00 seconds</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Phase Exploration Phase converged at iteration 6. </span></span>
<span><span class="co">#&gt; Phase Refinement Phase converged at iteration 13. </span></span>
<span><span class="co">#&gt; Phase Final Phase converged at iteration 21. </span></span>
<span><span class="co">#&gt; Phase Final Phase 2 converged at iteration 29. </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Chain 4 Complete: Final NLL = -1845.280, Time Elapsed = 9.37 seconds</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Phase Exploration Phase converged at iteration 15. </span></span>
<span><span class="co">#&gt; Phase Refinement Phase converged at iteration 19. </span></span>
<span><span class="co">#&gt; Phase Final Phase converged at iteration 24. </span></span>
<span><span class="co">#&gt; Phase Final Phase 2 converged at iteration 32. </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Chain 5 Complete: Final NLL = -1845.282, Time Elapsed = 11.10 seconds</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p>This is the output of the <code>fitEM</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; -- FitEM Summary --</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -- Objective Function and Information Criteria --</span></span>
<span><span class="co">#&gt;  Log-likelihood: -1845.2844</span></span>
<span><span class="co">#&gt;             AIC: 3701.57</span></span>
<span><span class="co">#&gt;             BIC: 3758.93</span></span>
<span><span class="co">#&gt; Condition#(Cov): 147.82</span></span>
<span><span class="co">#&gt; Condition#(Cor): 209.77</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -- Timing Information --</span></span>
<span><span class="co">#&gt;      Best Chain: 9.9991 seconds</span></span>
<span><span class="co">#&gt;      All Chains: 46.5036 seconds</span></span>
<span><span class="co">#&gt;      Covariance: 34.5494 seconds</span></span>
<span><span class="co">#&gt;         Elapsed: 81.05 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -- Population Parameters --</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;   Parameter        Est.      SE  `%RSE` `Back-transformed(95%CI)` `BSV(CV%)`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> cl             1.60    0.015<span style="text-decoration: underline;">3</span>   0.955 4.96 (4.81, 5.11)               31.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> v1             2.31    0.085<span style="text-decoration: underline;">2</span>   3.69  10.07 (8.52, 11.90)             33.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> v2             3.40    0.039<span style="text-decoration: underline;">7</span>   1.17  30.10 (27.84, 32.53)            31.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> q              2.28    0.021<span style="text-decoration: underline;">2</span>   0.929 9.82 (9.42, 10.24)              32.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> ka             0.020<span style="text-decoration: underline;">2</span>  0.080<span style="text-decoration: underline;">4</span> 398.    1.02 (0.87, 1.19)               30.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Residual Error 0.039<span style="text-decoration: underline;">4</span> <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>     0.0394                          <span style="color: #BB0000;">NA</span>  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -- Iteration Diagnostics --</span></span>
<span><span class="co">#&gt;  Iter | NLL and Parameters</span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;    1: -1500.455 1.327 2.144 3.211 2.179 0.000 -2.353 -2.172 -2.458 -2.745 -2.346 -3.361</span></span>
<span><span class="co">#&gt;    2: -1844.508 1.610 2.346 3.371 2.298 0.056 -2.297 -2.237 -2.565 -2.134 -2.364 -3.231</span></span>
<span><span class="co">#&gt;    3: -1845.284 1.601 2.309 3.404 2.285 0.020 -2.285 -2.210 -2.337 -2.266 -2.399 -3.235</span></span>
<span><span class="co">#&gt;    4: -1845.281 1.601 2.308 3.405 2.285 0.019 -2.286 -2.203 -2.343 -2.263 -2.408 -3.235</span></span>
<span><span class="co">#&gt;    5: -1845.281 1.601 2.308 3.405 2.285 0.019 -2.286 -2.203 -2.343 -2.263 -2.408 -3.235</span></span>
<span><span class="co">#&gt;    6: -1845.284 1.601 2.309 3.405 2.285 0.020 -2.286 -2.206 -2.341 -2.264 -2.403 -3.235</span></span>
<span><span class="co">#&gt;    7: -1845.281 1.601 2.307 3.405 2.285 0.018 -2.286 -2.204 -2.343 -2.266 -2.407 -3.235</span></span>
<span><span class="co">#&gt;    8: -1845.281 1.601 2.307 3.405 2.285 0.018 -2.286 -2.203 -2.343 -2.266 -2.408 -3.235</span></span>
<span><span class="co">#&gt;    9: -1845.281 1.601 2.307 3.405 2.285 0.018 -2.286 -2.203 -2.343 -2.266 -2.408 -3.235</span></span>
<span><span class="co">#&gt;   10: -1845.281 1.601 2.307 3.405 2.285 0.018 -2.286 -2.203 -2.343 -2.266 -2.408 -3.235</span></span>
<span><span class="co">#&gt;   11: -1845.281 1.601 2.307 3.405 2.285 0.018 -2.286 -2.203 -2.343 -2.266 -2.408 -3.235</span></span>
<span><span class="co">#&gt;   12: -1845.282 1.601 2.308 3.405 2.285 0.019 -2.286 -2.203 -2.343 -2.263 -2.408 -3.235</span></span>
<span><span class="co">#&gt;   13: -1845.281 1.601 2.308 3.405 2.285 0.019 -2.286 -2.201 -2.343 -2.265 -2.410 -3.235</span></span>
<span><span class="co">#&gt;   14: -1845.281 1.601 2.308 3.405 2.285 0.018 -2.286 -2.201 -2.343 -2.265 -2.410 -3.235</span></span>
<span><span class="co">#&gt;   15: -1845.281 1.601 2.308 3.405 2.285 0.018 -2.286 -2.201 -2.343 -2.265 -2.410 -3.235</span></span>
<span><span class="co">#&gt;   16: -1845.281 1.601 2.308 3.405 2.285 0.019 -2.286 -2.201 -2.343 -2.264 -2.410 -3.235</span></span>
<span><span class="co">#&gt;   17: -1845.281 1.601 2.308 3.405 2.285 0.019 -2.286 -2.201 -2.343 -2.264 -2.410 -3.235</span></span>
<span><span class="co">#&gt;   18: -1845.282 1.601 2.309 3.404 2.285 0.019 -2.286 -2.204 -2.345 -2.262 -2.407 -3.235</span></span>
<span><span class="co">#&gt;   19: -1845.282 1.601 2.308 3.405 2.285 0.019 -2.286 -2.204 -2.344 -2.263 -2.407 -3.235</span></span>
<span><span class="co">#&gt;   20: -1845.282 1.601 2.308 3.405 2.285 0.019 -2.286 -2.203 -2.343 -2.263 -2.408 -3.235</span></span>
<span><span class="co">#&gt;   21: -1845.282 1.601 2.308 3.405 2.285 0.019 -2.286 -2.203 -2.343 -2.263 -2.408 -3.235</span></span>
<span><span class="co">#&gt;   22: -1845.282 1.601 2.308 3.405 2.285 0.019 -2.286 -2.203 -2.343 -2.263 -2.408 -3.235</span></span>
<span><span class="co">#&gt;   23: -1845.282 1.601 2.308 3.405 2.285 0.019 -2.286 -2.202 -2.343 -2.263 -2.408 -3.235</span></span>
<span><span class="co">#&gt;   24: -1845.281 1.601 2.308 3.405 2.285 0.019 -2.286 -2.202 -2.343 -2.263 -2.409 -3.235</span></span>
<span><span class="co">#&gt;   25: -1845.281 1.601 2.308 3.405 2.285 0.019 -2.286 -2.202 -2.343 -2.263 -2.409 -3.235</span></span>
<span><span class="co">#&gt;   26: -1845.281 1.601 2.308 3.405 2.285 0.019 -2.286 -2.202 -2.343 -2.263 -2.409 -3.235</span></span>
<span><span class="co">#&gt;   27: -1845.281 1.601 2.308 3.405 2.285 0.019 -2.286 -2.202 -2.343 -2.263 -2.409 -3.235</span></span></code></pre></div>
<p>The <code>plot</code> function can be used to visualize the results.
It shows the convergence of the model fit and parameters by making a
trace plot of the chains.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="admr_files/figure-html/unnamed-chunk-9-1.png" width="700"><img src="admr_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by H. van de Beek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
